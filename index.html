<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Ecommerce Barber√≠a - Juan Esteban</title>

<!-- PALETA VERDE CLARO + BLANCO -->
<style>
  :root {
    --verde-claro: #86efac;
    --verde: #22c55e;
    --verde-oscuro: #15803d;
    --blanco: #ffffff;
    --gris: #f4f4f4;
  }

  body {
    font-family: system-ui;
    background-color: var(--gris);
    color: #333;
    padding: 20px;
    text-align: center;
  }

  h1 {
    color: var(--verde-oscuro);
    margin-bottom: 20px;
  }

  /* Filtro */
  #categoria {
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
    margin-bottom: 20px;
  }

  /* Tarjetas */
  .producto {
    border: 1px solid #ccc;
    background: var(--blanco);
    border-radius: 10px;
    padding: 10px;
    margin: 12px;
    display: inline-block;
    width: 220px;
    vertical-align: top;
    box-shadow: 0 3px 8px rgba(0,0,0,0.10);
  }

  .producto img {
    width: 100%;
    height: 150px;
    object-fit: cover;
    border-radius: 6px;
  }

  .producto button {
    background-color: var(--verde);
    border: none;
    color: white;
    padding: 8px;
    margin-top: 6px;
    border-radius: 6px;
    cursor: pointer;
    width: 100%;
  }

  .producto button:hover {
    background-color: var(--verde-oscuro);
  }

  /* Carrito */
  .carrito {
    margin-top: 40px;
    padding: 20px;
    background: var(--blanco);
    border-radius: 12px;
    text-align: left;
    display: inline-block;
    width: 350px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.15);
  }

  .carrito h2 {
    color: var(--verde-oscuro);
  }

  .carrito button {
    background-color: var(--verde);
    color: white;
    padding: 8px;
    margin-top: 8px;
    border-radius: 6px;
    border: none;
    width: 100%;
    cursor: pointer;
  }

  .vaciar {
    background-color: #dc3545 !important;
  }

  .vaciar:hover {
    background-color: #b02a37 !important;
  }

  /* Totales */
  .totales {
    margin-top: 15px;
  }

  #paypal-button-container {
    margin-top: 15px;
  }
</style>
</head>

<body>

<h1>üçΩÔ∏è Ecommerce Servicio de Barber√≠a - Juan Esteban Ram√≠rez</h1>

<!-- Filtro -->
<select id="categoria">
  <option value="todos">Todas las categor√≠as</option>
  <option value="Corte">Corte</option>
  <option value="Barba">Barba</option>
  <option value="Cejas">Cejas</option>
  <option value="Dise√±o">Dise√±o</option>
</select>

<!-- Productos -->
<div id="productos"></div>

<!-- Carrito -->
<div class="carrito">
  <h2>üõí Carrito (0)</h2>
  <ul id="lista-carrito"></ul>

  <div class="totales">
    <p>Subtotal: <strong>$<span id="subtotal-text">0</span></strong></p>
    <p>Impuestos (19%): <strong>$<span id="impuestos-text">0</span></strong></p>
    <p>Descuento: <strong>$<span id="descuento-text">0</span></strong></p>
    <hr>
    <p>Total: <strong>$<span id="total-text">0</span></strong></p>
  </div>

  <button id="btn-vaciar" class="vaciar">üßº Vaciar Carrito</button>
  <button id="btn-finalizar">‚úÖ Finalizar Compra</button>

  <div id="paypal-button-container"></div>
</div>

<!-- JS LOGICA -->
<script>
// =======================
// DATASET CON CATEGOR√çAS
// =======================
const productos = [
  {
    id: 1,
    nombre: "Corte de pelo sencillo",
    categoria: "Corte",
    precio: 18000,
    imagen: "https://content.clara.es/medio/2025/02/24/cortes-de-pelo-corto-para-hombre-henry-cavill_36e69abd_250224165919_1920x1280.webp"
  },
  {
    id: 2,
    nombre: "Corte y barba",
    categoria: "Corte",
    precio: 26000,
    imagen: "https://hips.hearstapps.com/hmg-prod/images/dscf2511-665f190e73fcf.jpg?crop=1xw:0.9375xh;center,top&resize=980:*"
  },
  {
    id: 3,
    nombre: "Dise√±o, cejas y corte",
    categoria: "Dise√±o",
    precio: 20000,
    imagen: "https://citas.hairspremium.com/wp-content/uploads/2021/09/figuras-en-corte.jpg"
  },
  {
    id: 4,
    nombre: "Cejas",
    categoria: "Cejas",
    precio: 4000,
    imagen: "https://2356021.fs1.hubspotusercontent-na1.net/hubfs/2356021/linea%20en%20la%20ceja%20hombre%20barberia.webp"
  },
  {
    id: 5,
    nombre: "Barba",
    categoria: "Barba",
    precio: 15000,
    imagen: "https://www.bellaroma.mx/wp-content/uploads/2021/07/barba-delineada.jpg"
  }
];

// =========================
//  UTILIDADES
// =========================
const COP = new Intl.NumberFormat("es-CO");

// =========================
//  CARRITO CON MAP()
// =========================
let carrito = new Map();

// Cargar carrito desde localStorage
if (localStorage.getItem("carrito")) {
  carrito = new Map(JSON.parse(localStorage.getItem("carrito")));
}

// =========================
//  SELECTORES
// =========================
const contenedorProductos = document.getElementById("productos");
const listaCarrito = document.getElementById("lista-carrito");
const subtotalText = document.getElementById("subtotal-text");
const impuestosText = document.getElementById("impuestos-text");
const descuentoText = document.getElementById("descuento-text");
const totalText = document.getElementById("total-text");
const tituloCarrito = document.querySelector(".carrito h2");

document.getElementById("btn-vaciar").onclick = vaciarCarrito;
document.getElementById("btn-finalizar").onclick = finalizarCompra;
document.getElementById("categoria").onchange = filtrar;

// =========================
//  RENDER DE PRODUCTOS
// =========================
function renderProductos(lista) {
  contenedorProductos.innerHTML = "";
  lista.forEach(prod => {
    const div = document.createElement("div");
    div.className = "producto";
    div.innerHTML = `
      <img src="${prod.imagen}" alt="${prod.nombre}" onerror="this.src='fallback.jpg'">
      <h3>${prod.nombre}</h3>
      <p>${prod.categoria}</p>
      <p><strong>$${COP.format(prod.precio)}</strong></p>
      <button onclick="agregar(${prod.id})">Agregar</button>
    `;
    contenedorProductos.appendChild(div);
  });
}

function filtrar() {
  const cat = document.getElementById("categoria").value;
  if (cat === "todos") renderProductos(productos);
  else renderProductos(productos.filter(p => p.categoria === cat));
}

// =========================
//  L√ìGICA DEL CARRITO (MAP)
// =========================
function agregar(id) {
  const prod = productos.find(p => p.id === id);
  if (carrito.has(id)) carrito.get(id).cantidad++;
  else carrito.set(id, { ...prod, cantidad: 1 });

  guardarCarrito();
  renderCarrito();
}

function renderCarrito() {
  listaCarrito.innerHTML = "";
  let subtotal = 0;
  let totalItems = 0;

  carrito.forEach(item => {
    subtotal += item.precio * item.cantidad;
    totalItems += item.cantidad;

    const li = document.createElement("li");
    li.innerHTML = `
      ${item.nombre} - $${COP.format(item.precio)} x ${item.cantidad}
      <button onclick="sumar(${item.id})">+</button>
      <button onclick="restar(${item.id})">-</button>
      <button onclick="eliminar(${item.id})">üóë</button>
    `;
    listaCarrito.appendChild(li);
  });

  // Totales
  const impuestos = subtotal * 0.19;
  const descuento = subtotal > 50000 ? 5000 : 0;
  const total = subtotal + impuestos - descuento;

  subtotalText.textContent = COP.format(subtotal);
  impuestosText.textContent = COP.format(impuestos);
  descuentoText.textContent = COP.format(descuento);
  totalText.textContent = COP.format(total);

  tituloCarrito.textContent = `üõí Carrito (${totalItems})`;

  renderPayPal(total);
}

function sumar(id) {
  carrito.get(id).cantidad++;
  guardarCarrito();
  renderCarrito();
}

function restar(id) {
  carrito.get(id).cantidad--;
  if (carrito.get(id).cantidad <= 0) carrito.delete(id);
  guardarCarrito();
  renderCarrito();
}

function eliminar(id) {
  carrito.delete(id);
  guardarCarrito();
  renderCarrito();
}

function vaciarCarrito() {
  if (confirm("¬øVaciar carrito?")) {
    carrito.clear();
    guardarCarrito();
    renderCarrito();
  }
}

function finalizarCompra() {
  if (carrito.size === 0) return alert("Carrito vac√≠o");

  alert("üéâ ¬°Compra realizada!");
  carrito.clear();
  guardarCarrito();
  renderCarrito();
}

function guardarCarrito() {
  localStorage.setItem("carrito", JSON.stringify([...carrito]));
}

// =========================
//  PAYPAL SANDBOX
// =========================
function renderPayPal(total) {
  const cont = document.getElementById("paypal-button-container");
  cont.innerHTML = "";

  if (total <= 0) return;

  paypal.Buttons({
    createOrder: (data, actions) => {
      return actions.order.create({
        purchase_units: [{
          amount: { value: String((total / 1000).toFixed(2)) }
        }]
      });
    },
    onApprove: () => {
      alert("Pago aprobado ‚úî");
      carrito.clear();
      guardarCarrito();
      renderCarrito();
    }
  }).render("#paypal-button-container");
}
</script>

<!-- SDK PAYPAL SANDBOX -->
<script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD"></script>

<script>
// Inicializaci√≥n
filtrar();
renderCarrito();
</script>

</body>
</html>
